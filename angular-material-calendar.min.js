angular.module("materialCalendar",["ngMaterial","ngSanitize"]),angular.module("materialCalendar").constant("materialCalendar.config",{version:"0.2.13",debug:document.domain.indexOf("localhost")>-1}),angular.module("materialCalendar").config(["materialCalendar.config","$logProvider","$compileProvider",function(t,e,a){t.debug&&(e.debugEnabled(!1),a.debugInfoEnabled(!1))}]),angular.module("materialCalendar").service("materialCalendar.Calendar",[function(){function t(t,e,a){var n=new Date;this.setWeekStartsOn=function(t){var e=parseInt(t||0,10);return this.weekStartsOn=!isNaN(e)&&e>=0&&6>=e?e:0,this.weekStartsOn},this.options=angular.isObject(a)?a:{},this.year=n.getFullYear(),this.month=n.getMonth(),this.weeks=[],this.weekStartsOn=this.setWeekStartsOn(this.options.weekStartsOn),this.next=function(){return this.start.getMonth()<11?void this.init(this.start.getFullYear(),this.start.getMonth()+1):void this.init(this.start.getFullYear()+1,0)},this.prev=function(){return this.month?void this.init(this.start.getFullYear(),this.start.getMonth()-1):void this.init(this.start.getFullYear()-1,11)},this.init=function(t,e){var a=new Date;this.year=angular.isDefined(t)?t:a.getFullYear(),this.month=angular.isDefined(e)?e:a.getMonth();var n=[31,28,31,30,31,30,31,31,30,31,30,31],r=n[this.month];1===this.month&&(this.year%4===0&&this.year%100!==0||this.year%400===0)&&(r=29),this.start=new Date(this.year,this.month,1);for(var o=angular.copy(this.start);o.getDay()!==this.weekStartsOn;)o.setDate(o.getDate()-1),r++;for(;r%7!==0;)r++;this.weeks=[];for(var i=0;r>i;++i)i%7===0&&this.weeks.push([]),this.weeks[this.weeks.length-1].push(angular.copy(o)),o.setDate(o.getDate()+1)},this.init(t,e)}return t}]),angular.module("materialCalendar").service("MaterialCalendarData",[function(){function t(){this.data={},this.getDayKey=function(t){return[t.getFullYear(),t.getMonth()+1,t.getDate()].join("-")},this.setDayContent=function(t,e){this.data[this.getDayKey(t)]=e||this.data[this.getDayKey(t)]||""}}return new t}]),angular.module("materialCalendar").directive("calendarMd",["$compile","$parse","$http","$q","materialCalendar.Calendar","MaterialCalendarData",function(t,e,a,n,r,o){var i="<div data-ng-include='templateUrl' style='width: 100%;'></div>",l=function(){var t="calendarMdCss";if(!document.getElementById(t)){var e=document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.id=t,a.innerHTML="calendar-md md-content>md-content.agenda>*>* :not(:first-child),calendar-md md-content>md-content.calendar>:not(:first-child)>* :last-child{overflow:hidden;text-overflow:ellipsis}calendar-md{display:block;max-height:100%}calendar-md .md-toolbar-tools h2{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}calendar-md md-content>md-content{border:1px solid rgba(0,0,0,.12)}calendar-md md-content>md-content.agenda>*>*{border-bottom:1px solid rgba(0,0,0,.12)}calendar-md md-content>md-content.agenda>*>.disabled{color:rgba(0,0,0,.3);pointer-events:none;cursor:auto}calendar-md md-content>md-content.agenda>*>* :first-child{padding:12px;width:200px;text-align:right;color:rgba(0,0,0,.75);font-weight:100;overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap}calendar-md md-content>md-content>*>*{min-width:48px}calendar-md md-content>md-content.calendar>:first-child{background:rgba(0,0,0,.02);border-bottom:1px solid rgba(0,0,0,.12);margin-right:0;min-height:36px}calendar-md md-content>md-content.calendar>:not(:first-child)>*{border-bottom:1px solid rgba(0,0,0,.12);border-right:1px solid rgba(0,0,0,.12);cursor:pointer}calendar-md md-content>md-content.calendar>:not(:first-child)>:hover{background:rgba(0,0,0,.04)}calendar-md md-content>md-content.calendar>:not(:first-child)>.disabled{color:rgba(0,0,0,.3);pointer-events:none;cursor:auto}calendar-md md-content>md-content.calendar>:not(:first-child)>.active{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);background:rgba(0,0,0,.02)}calendar-md md-content>md-content.calendar>:not(:first-child)>* :first-child{padding:0}",e.insertBefore(a,e.firstChild)}};return{restrict:"E",scope:{ngModel:"=?",template:"&",needsRefresh:"=?",templateUrl:"=?",onDayClick:"=?",onPrevMonth:"=?",onNextMonth:"=?",calendarDirection:"=?",dayContent:"&?",timezone:"=?",titleFormat:"=?",dayFormat:"=?",dayLabelFormat:"=?",dayLabelTooltipFormat:"=?",dayTooltipFormat:"=?",weekStartsOn:"=?",tooltips:"&?",clearDataCacheOnLoad:"=?",disableFutureSelection:"=?"},link:function(a,n,d){l();var c=new Date,s=parseInt(d.startMonth||c.getMonth()),u=parseInt(d.startYear||c.getFullYear());a.columnWeekLayout="column",a.weekLayout="row",a.timezone=a.timezone||null,a.noCache=d.clearDataCacheOnLoad||!1,d.ngModel?(a.active=a.$parent.$eval(d.ngModel),d.ngModel&&a.$watch("$parent."+d.ngModel,function(t){a.active=t})):a.active=null,a.titleFormat=a.titleFormat||"MMMM yyyy",a.dayLabelFormat=a.dayLabelFormat||"EEE",a.dayLabelTooltipFormat=a.dayLabelTooltipFormat||"EEEE",a.dayFormat=a.dayFormat||"d",a.dayTooltipFormat=a.dayTooltipFormat||"fullDate",a.disableFutureSelection=a.disableFutureSelection||!1,a.sameMonth=function(t){var e=angular.copy(t);return e.getFullYear()===a.calendar.year&&e.getMonth()===a.calendar.month},a.isDisabled=function(t){return a.disableFutureSelection&&t>new Date?!0:!a.sameMonth(t)},a.isToday=function(t){var e=new Date;return e.setHours(0,0,0,0),e.getTime()==t.getTime()},a.calendarDirection=a.calendarDirection||"horizontal",a.$watch("calendarDirection",function(t){a.weekLayout="horizontal"===t?"row":"column"}),a.$watch("weekLayout",function(){u=a.calendar.year,s=a.calendar.month,b()});var h=function(t,e){(t||angular.noop)(e)},m=function(t,e){var a=-1;return angular.forEach(t,function(t,n){0>a&&angular.equals(e,t)&&(a=n)}),a};a.isActive=function(t){var e,n=angular.copy(a.active);return e=angular.isArray(n)?m(n,t)>-1:angular.equals(t,n)},a.prev=function(){a.calendar.prev();var t={year:a.calendar.year,month:a.calendar.month+1};v(),h(a.onPrevMonth,t)},a.next=function(){a.calendar.next();var t={year:a.calendar.year,month:a.calendar.month+1};v(),h(a.onNextMonth,t)},a.handleDayClick=function(t){if(!(a.disableFutureSelection&&t>new Date)){var n=angular.copy(a.active);if(angular.isArray(n)){var r=m(n,t);r>-1?n.splice(r,1):n.push(t)}else n=angular.equals(n,t)?null:t;a.active=n,d.ngModel&&e(d.ngModel).assign(a.$parent,angular.copy(a.active)),h(a.onDayClick,angular.copy(t))}};var g=function(e){n.html(e),t(n.contents())(a)},f=function(){return a.calendar=new r(u,s,{weekStartsOn:a.weekStartsOn||0}),i};a.dataService=o;var p=function(t){return a.dataService.getDayKey(t)};a.dayKey=p;var y=function(t){a.noCache?a.dataService.setDayContent(t,""):a.dataService.setDayContent(t,a.dataService.data[p(t)]||"");var e=(a.dayContent||angular.noop)(),n=(e||angular.noop)(t);angular.isObject(n)&&"function"==typeof n.success?n.success(function(e){a.dataService.setDayContent(t,e)}):angular.isObject(n)&&"function"==typeof n.then?n.then(function(e){a.dataService.setDayContent(t,e)}):a.dataService.setDayContent(t,n)},v=function(){angular.forEach(a.calendar.weeks,function(t){angular.forEach(t,y)})};window.data=a.data;var b=function(){var t=f();g(t),v()};a.$watch("needsRefresh",function(t){1==t&&(console.log("Refreshing"),v(),a.needsRefresh=!1)}),a.$watch("weekStartsOn",f),b(),a._$$init=f,a._$$setTemplate=g,a._$$bootstrap=b}}}]);